(function(_1){if(typeof define==="function"&&define.amd){define(["jquery"],_1);}else{_1(jQuery);}}(function($){$.fn.tweet=function(o){var s=$.extend({username:null,list:null,favorites:false,query:null,avatar_size:null,count:3,fetch:null,page:1,retweets:true,intro_text:null,outro_text:null,join_text:null,auto_join_text_default:"I said,",auto_join_text_ed:"I",auto_join_text_ing:"I am",auto_join_text_reply:"I replied to",auto_join_text_url:"I was looking at",loading_text:null,refresh_interval:null,twitter_url:"twitter.com",twitter_api_url:"api.twitter.com",twitter_search_url:"search.twitter.com",template:"{avatar}{time}{join}{text}",comparator:function(_2,_3){return _3["tweet_time"]-_2["tweet_time"];},filter:function(_4){return true;}},o);var _5=/\b((?:https?:\/\/|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?????????????????]))/gi;function t(_6,_7){if(typeof _6==="string"){var _8=_6;for(var _9 in _7){var _a=_7[_9];_8=_8.split("{"+_9+"}").join(_a===null?"":_a);}return _8;}else{return _6(_7);}};$.extend({tweet:{t:t}});function _b(_c,_d){return function(){var _e=[];this.each(function(){_e.push(this.replace(_c,_d));});return $(_e);};};function _f(s){return s.replace(/</g,"&lt;").replace(/>/g,"^&gt;");};$.fn.extend({linkUser:_b(/(^|[\W])@(\w+)/gi,"$1<span class=\"at\">@</span><a href=\"http://"+s.twitter_url+"/$2\">$2</a>"),linkHash:_b(/(?:^| )[\#]+([\w\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u00ff\u0600-\u06ff]+)/gi," <a href=\"http://"+s.twitter_search_url+"/search?q=&tag=$1&lang=all"+((s.username&&s.username.length==1&&!s.list)?"&from="+s.username.join("%2BOR%2B"):"")+"\" class=\"tweet_hashtag\">#$1</a>"),makeHeart:_b(/(&lt;)+[3]/gi,"<tt class='heart'>&#x2665;</tt>")});function _10(_11,_12){return _11.replace(_5,function(_13){var url=(/^[a-z]+:/i).test(_13)?_13:"http://"+_13;var _14=_13;for(var i=0;i<_12.length;++i){var _15=_12[i];if(_15.url==url&&_15.expanded_url){url=_15.expanded_url;_14=_15.display_url;break;}}return "<a href=\""+_f(url)+"\">"+_f(_14)+"</a>";});};function _16(_17){return Date.parse(_17.replace(/^([a-z]{3})( [a-z]{3} \d\d?)(.*)( \d{4})$/i,"$1,$2$4$3"));};function _18(_19){var _1a=function(val){return parseInt(val,10);};var _1b=new Date();var _1c=_1a((_1b.getTime()-_19)/1000);if(_1c<1){_1c=0;}return {days:_1a(_1c/86400),hours:_1a(_1c/3600),minutes:_1a(_1c/60),seconds:_1a(_1c)};};function _1d(_1e){if(_1e.days>2){return "about "+_1e.days+" days ago";}if(_1e.hours>24){return "about a day ago";}if(_1e.hours>2){return "about "+_1e.hours+" hours ago";}if(_1e.minutes>45){return "about an hour ago";}if(_1e.minutes>2){return "about "+_1e.minutes+" minutes ago";}if(_1e.seconds>1){return "about "+_1e.seconds+" seconds ago";}return "just now";};function _1f(_20){if(_20.match(/^(@([A-Za-z0-9-_]+)) .*/i)){return s.auto_join_text_reply;}else{if(_20.match(_5)){return s.auto_join_text_url;}else{if(_20.match(/^((\w+ed)|just) .*/im)){return s.auto_join_text_ed;}else{if(_20.match(/^(\w*ing) .*/i)){return s.auto_join_text_ing;}else{return s.auto_join_text_default;}}}}};function _21(){var _22=("https:"==document.location.protocol?"https:":"http:");var _23=(s.fetch===null)?s.count:s.fetch;var _24="&include_entities=1&callback=?";if(s.list){return _22+"//"+s.twitter_api_url+"/1/"+s.username[0]+"/lists/"+s.list+"/statuses.json?page="+s.page+"&per_page="+_23+_24;}else{if(s.favorites){return _22+"//"+s.twitter_api_url+"/favorites/"+s.username[0]+".json?page="+s.page+"&count="+_23+_24;}else{if(s.query===null&&s.username.length==1){return _22+"//"+s.twitter_api_url+"/1/statuses/user_timeline.json?screen_name="+s.username[0]+"&count="+_23+(s.retweets?"&include_rts=1":"")+"&page="+s.page+_24;}else{var _25=(s.query||"from:"+s.username.join(" OR from:"));return _22+"//"+s.twitter_search_url+"/search.json?&q="+encodeURIComponent(_25)+"&rpp="+_23+"&page="+s.page+_24;}}}};function _26(_27,_28){if(_28){return ("user" in _27)?_27.user.profile_image_url_https:_26(_27,false).replace(/^http:\/\/[a-z0-9]{1,3}\.twimg\.com\//,"https://s3.amazonaws.com/twitter_production/");}else{return _27.profile_image_url||_27.user.profile_image_url;}};function _29(_2a){var o={};o.item=_2a;o.source=_2a.source;o.screen_name=_2a.from_user||_2a.user.screen_name;o.name=_2a.from_user_name||_2a.user.name;o.retweet=typeof (_2a.retweeted_status)!="undefined";o.tweet_time=_16(_2a.created_at);o.join_text=s.join_text=="auto"?_1f(_2a.text):s.join_text;o.tweet_id=_2a.id_str;o.twitter_base="http://"+s.twitter_url+"/";o.user_url=o.twitter_base+o.screen_name;o.tweet_url=o.user_url+"/status/"+o.tweet_id;o.reply_url=o.twitter_base+"intent/tweet?in_reply_to="+o.tweet_id;o.retweet_url=o.twitter_base+"intent/retweet?tweet_id="+o.tweet_id;o.favorite_url=o.twitter_base+"intent/favorite?tweet_id="+o.tweet_id;o.retweeted_screen_name=o.retweet&&_2a.retweeted_status.user.screen_name;o.tweet_relative_time=_1d(_18(o.tweet_time));o.entities=_2a.entities?(_2a.entities.urls||[]).concat(_2a.entities.media||[]):[];o.tweet_raw_text=o.retweet?("RT @"+o.retweeted_screen_name+" "+_2a.retweeted_status.text):_2a.text;o.tweet_text=$([_10(o.tweet_raw_text,o.entities)]).linkUser().linkHash()[0];o.tweet_text_fancy=$([o.tweet_text]).makeHeart()[0];o.avatar_size=s.avatar_size;o.avatar_url=_26(o.retweet?_2a.retweeted_status:_2a,(document.location.protocol==="https:"));o.avatar_screen_name=o.retweet?o.retweeted_screen_name:o.screen_name;o.avatar_profile_url=o.twitter_base+o.avatar_screen_name;o.user=t("<a class=\"tweet_user\" href=\"{user_url}\">{screen_name}</a>",o);o.join=s.join_text?t(" <span class=\"tweet_join\">{join_text}</span> ",o):" ";o.avatar=o.avatar_size?t("<a class=\"tweet_avatar\" href=\"{avatar_profile_url}\"><img src=\"{avatar_url}\" height=\"{avatar_size}\" width=\"{avatar_size}\" alt=\"{avatar_screen_name}'s avatar\" title=\"{avatar_screen_name}'s avatar\" border=\"0\"/></a>",o):"";o.time=t("<span class=\"tweet_time\"><a href=\"{tweet_url}\" title=\"view tweet on twitter\">{tweet_relative_time}</a></span>",o);o.text=t("<span class=\"tweet_text\">{tweet_text_fancy}</span>",o);o.reply_action=t("<a class=\"tweet_action tweet_reply\" href=\"{reply_url}\">reply</a>",o);o.retweet_action=t("<a class=\"tweet_action tweet_retweet\" href=\"{retweet_url}\">retweet</a>",o);o.favorite_action=t("<a class=\"tweet_action tweet_favorite\" href=\"{favorite_url}\">favorite</a>",o);return o;};function _2b(_2c){var _2d="<p class=\"tweet_intro\">"+s.intro_text+"</p>";var _2e="<p class=\"tweet_outro\">"+s.outro_text+"</p>";var _2f=$("<p class=\"loading\">"+s.loading_text+"</p>");if(s.loading_text){$(_2c).not(":has(.tweet_list)").empty().append(_2f);}$.getJSON(_21(),function(_30){var _31=$("<ul class=\"tweet_list\">");var _32=$.map(_30.results||_30,_29);_32=$.grep(_32,s.filter).sort(s.comparator).slice(0,s.count);_31.append($.map(_32,function(o){return "<li>"+t(s.template,o)+"</li>";}).join("")).children("li:first").addClass("tweet_first").end().children("li:odd").addClass("tweet_even").end().children("li:last").addClass("tweet_last").end().children("li:even").addClass("tweet_odd");$(_2c).empty().append(_31);if(s.intro_text){_31.before(_2d);}if(s.outro_text){_31.after(_2e);}$(_2c).trigger("loaded").trigger((_32.length===0?"empty":"full"));if(s.refresh_interval){window.setTimeout(function(){$(_2c).trigger("tweet:load");},1000*s.refresh_interval);}});};return this.each(function(i,_33){if(s.username&&typeof (s.username)=="string"){s.username=[s.username];}$(_33).unbind("tweet:load").bind("tweet:load",function(){_2b(_33);}).trigger("tweet:load");});};}));